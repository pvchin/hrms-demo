(this.webpackJsonphrms=this.webpackJsonphrms||[]).push([[2],{1094:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return L}));var n=a(25),r=a(4),c=a(9),i=a(1),l=a(27),s=a.n(l),o=a(87),d=a(23),u=a(75),j=a(404),b=a(226),m=a(348),p=a(19),O=a(50),h=a(77),f=a(30),x=a(7),g=a.n(x),v=a(12),C=a(16),S=a(13),w=a(361),y=a(26),E=a.n(y),I=a(37);function _(){return(_=Object(v.a)(g.a.mark((function e(t,a){var n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("".concat(S.j,"?m=").concat(t,"&y=").concat(a));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){var t=Object(i.useState)("all"),a=Object(c.a)(t,2),n=a[0],r=a[1],l=Object(i.useState)(""),s=Object(c.a)(l,2),o=s[0],d=s[1],u=Object(i.useState)(""),j=Object(c.a)(u,2),b=j[0],m=j[1],p=Object(i.useCallback)((function(e){return Object(w.c)(e,n)}),[n]),O=Object(C.useQuery)([I.a.expensesperiod,b,o],(function(){return function(e,t){return _.apply(this,arguments)}(b,o)}),{select:"all"!==n?p:void 0}).data;return{expensesperiod:void 0===O?[]:O,expperiodfilter:n,setExpPeriodFilter:r,setExpPeriodYrId:d,setExpPeriodMthId:m}}var k=a(102),F=a(845),V=a(320),P=a(321),N=a(323),A=a(360),T=a(2),z={name:"",date:"",purchased_from:"",description:"",status:"Pending",amount:0,attachment1_name:"",attachment1_url:"",attachment2_name:"",attachment2_url:"",attachment3_name:"",attachment3_url:""};function L(e){var t=e.year,a=e.month,l=M(),o=Object(p.a)(),x=Object(d.c)(f.f),g=Object(c.a)(x,2),v=g[0],C=(g[1],Object(i.useState)(0)),S=Object(c.a)(C,2),w=(S[0],S[1]),y=Object(i.useState)(!1),E=Object(c.a)(y,2),I=E[0],_=E[1],L=Object(i.useState)(!1),R=Object(c.a)(L,2),q=R[0],B=R[1],G=Object(i.useState)(z),J=Object(c.a)(G,2),U=J[0],W=J[1],Y=(Object(V.a)(),Object(P.a)()),$=Object(N.a)(),Q=($.expensesattachments,$.setAttachmentId),X=(Object(A.a)(),Object(i.useState)("")),H=Object(c.a)(X,2),K=(H[0],H[1]),Z=Object(i.useState)(!1),ee=Object(c.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(u.e)({defaultIsOpen:!1}),re=ne.isOpen,ce=(ne.onClose,ne.onOpen,D()),ie=ce.expensesperiod,le=ce.setExpPeriodYrId,se=ce.setExpPeriodMthId,oe=Object(k.b)(),de=oe.editExpenseID,ue=oe.setEditExpenseID,je=oe.setIsExpenseEditingOn,be=(oe.setIsExpenseEditingOff,Object(i.useMemo)((function(){return[{title:"Name",field:"name"},{title:"Date",field:"date",type:"date",dateSetting:{locale:"en-GB"}},{title:"Description",field:"description"},{title:"Amount",field:"amount",type:"currency"},{title:"Status",field:"status"}]}),[]));Object(i.useEffect)((function(){le(t),se(a),_(!0)}),[]),Object(i.useEffect)((function(){ie&&(me(),_(!1))}),[I]);var me=function(){var e=ie.reduce((function(e,t){return"Approved"===t.status||"Approve"===t.status?e+t.amount:e}),0);w(e)},pe=function(){B(!1)},Oe=function(e){var t=e.id;W(Object(r.a)({},e)),W(Object(r.a)({},e)),ue(t),je(),B(!0)},he=function(){ae(!0)};return Object(T.jsxs)("div",{className:l.root,children:[Object(T.jsx)(j.b,{maxW:"100%",pt:"5px",overflow:"scroll",children:Object(T.jsx)(s.a,{columns:be,data:ie,title:"Leave Application",actions:[function(e){return{icon:function(){return Object(T.jsx)(m.a,{size:"33px"})},tooltip:"View",onClick:function(e,t){Oe(t)}}},function(e){return{icon:function(){return Object(T.jsx)(m.b,{size:"23px"})},hidden:"Manager"!==v.loginLevel,tooltip:"Delete",onClick:function(e,t){!function(e){var t=e.id,a=e.attachmentid,c=(e.rec_id,e.tableData,Object(n.a)(e,["id","attachmentid","rec_id","tableData"])),i=Object(r.a)(Object(r.a)({},c),{},{posted:"D"});W(Object(r.a)({},i)),W(Object(r.a)({},i)),ue(t),Q(a),K(a),e.payrun?o({title:"This expense has been paid. It can not be deleted!",status:"error"}):he()}(t)}}}],options:{filtering:!1,search:!1,toolbar:!1,paging:!1,headerStyle:{backgroundColor:"rgba(75, 192, 192, 1)",color:"white"},showTitle:!1}})}),Object(T.jsx)(O.a,{isOpen:q,handleClose:pe,title:"",showButton:!0,isFullscreen:!1,isFullwidth:!1,children:Object(T.jsx)(F.a,{formdata:U,setFormdata:W,handleDialogClose:pe})}),Object(T.jsx)(h.a,{onClose:function(){ae(!1)},onConfirm:function(){var e=Object(r.a)(Object(r.a)({},U),{},{posted:"D"});Y(Object(r.a)({id:de},e))},isOpen:te,title:"Delete Expenses",children:Object(T.jsxs)("h2",{children:["Are you sure you want to delete ",U.name," expense dated on"," ",U.date," with amount $",U.amount," ?"]})}),re&&Object(T.jsxs)(b.a,{status:"error",children:[Object(T.jsx)(b.c,{}),Object(T.jsx)(j.b,{children:Object(T.jsx)(b.b,{children:"This Expenses has been paid! It can not be deleted!"})})]})]})}var M=Object(o.a)((function(e){return{root:{padding:0}}}))},845:function(e,t,a){"use strict";var n=a(25),r=(a(47),a(4)),c=a(9),i=a(1),l=a.n(i),s=a(98),o=a(88),d=a(133),u=a(87),j=a(23),b=(a(163),a(26),a(457)),m=a.n(b),p=a(459),O=a.n(p),h=a(75),f=a(404),x=a(579),g=a(405),v=a(212),C=a(296),S=a(30),w=a(102),y=a(29),E=a(19),I=a(464),_=a(320),D=a(321),k=a(323),F=a(2),V=l.a.lazy((function(){return Promise.all([a.e(6),a.e(7)]).then(a.bind(null,874))})),P=Object(u.a)((function(e){return{button:{margin:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},rightIcon:{marginLeft:e.spacing(1)},iconSmall:{fontSize:20},root:{padding:e.spacing(3,2)},container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:400}}}));t.a=function(e){var t=e.formdata,a=(e.setFormdata,e.handleDialogClose),l=P(),u=(Object(E.a)(),Object(D.a)()),b=Object(I.a)(),p=(Object(_.a)(),Object(k.a)()),N=p.expensesattachments,A=p.setAttachmentId,T=Object(j.c)(S.f),z=Object(c.a)(T,2),L=z[0],M=(z[1],Object(w.b)()),R=M.isExpenseEditing,q=M.editExpenseID,B=Object(i.useState)([]),G=Object(c.a)(B,2),J=G[0],U=G[1],W=Object(i.useState)(""),Y=Object(c.a)(W,2),$=(Y[0],Y[1],Object(i.useState)({})),Q=Object(c.a)($,2),X=(Q[0],Q[1],Object(j.c)(S.m)),H=Object(c.a)(X,2),K=H[0],Z=H[1],ee=Object(h.e)(),te=ee.isOpen,ae=ee.onOpen,ne=ee.onClose,re=Object(y.b)({defaultValues:Object(r.a)({},t)}),ce=re.handleSubmit,ie=re.control;re.setValue;return Object(i.useEffect)((function(){if(R){A(t.attachmentid);var e=N.filter((function(e){return e.attachmentid===t.attachmentid})).map((function(e){return{name:e.name,preview:e.url}}));U(e)}else U([])}),[N]),Object(F.jsxs)("div",{children:[Object(F.jsxs)(f.b,{size:"x1",children:[Object(F.jsx)(s.a,{variant:"h5",component:"h3",children:"EXPENSES CLAIM FORM"}),Object(F.jsx)(s.a,{component:"p",children:"Expense Claim Application"}),Object(F.jsx)("form",{onSubmit:ce((function(e,t){t.preventDefault();var c=Object(r.a)(Object(r.a)({},e),{},{attachment1_name:J.length>=1?J[0].name:"",attachment1_url:J.length>=1?J[0].preview:"",attachment2_name:J.length>=2?J[1].name:"",attachment2_url:J.length>=2?J[1].preview:"",attachment3_name:J.length>=3?J[2].name:"",attachment3_url:J.length>=3?J[2].preview:""});if(console.log("newdata",c),console.log("isEditing",R),R){c.rec_id,c.tableData;var i=Object(n.a)(c,["rec_id","tableData"]);u(Object(r.a)({id:q},i))}else b(Object(r.a)(Object(r.a)({},c),{},{empid:L.loginUserId,name:L.loginUser}));a()})),children:Object(F.jsxs)(f.f,{templateColumns:"repeat(3, 1fr)",gap:4,children:[Object(F.jsxs)(f.g,{colSpan:1,children:[Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"name",control:ie,defaultValue:t.name,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(o.a,{label:"Name",id:"margin-normal1",name:"name",defaultValue:t.name,className:l.textField,onChange:n,error:!!r,helperText:r?r.message:null,InputProps:{readOnly:!0}})}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"date",control:ie,defaultValue:t.date,render:function(e){var t=e.field,a=t.onChange,n=t.value,r=e.fieldState.error;return Object(F.jsx)(o.a,{label:"Date",type:"date",id:"margin-normal2",name:"formdata.date",value:n,className:l.textField,onChange:a,error:!!r,helperText:r?r.message:null,InputLabelProps:{shrink:!0}})},rules:{required:"From Date is required"}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"purchased_from",control:ie,defaultValue:t.purchased_from,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(o.a,{label:"Purchased From",id:"margin-normal3",name:"purchased_from",defaultValue:t.purchased_from,className:l.textField,onChange:n,error:!!r,helperText:r?r.message:null})}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"description",control:ie,defaultValue:t.description,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(o.a,{label:"Description",id:"margin-normal4",name:"description",defaultValue:t.description,className:l.textField,onChange:n,error:!!r,helperText:r?r.message:null})}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"amount",control:ie,defaultValue:t.amount,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(O.a,{label:"Amount",variant:"standard",value:t.amount,currencySymbol:"$",outputFormat:"string",decimalCharacter:".",digitGroupSeparator:",",decimalPlaces:"2",className:l.textField,id:"standard-amount",name:"amount",style:{width:100},onChange:function(e){n(parseFloat(m()(e.target.value),10))},error:!!r,helperText:r?r.message:null})}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"remark",control:ie,defaultValue:t.remark,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(o.a,{label:"Remark",id:"margin-normal5",name:"remark",defaultValue:t.remark,className:l.textField,onChange:n,error:!!r,helperText:r?r.message:null})}})}),Object(F.jsx)("div",{children:Object(F.jsx)(y.a,{name:"status",control:ie,defaultValue:t.status,render:function(e){var a=e.field,n=a.onChange,r=(a.value,e.fieldState.error);return Object(F.jsx)(o.a,{label:"Status",id:"margin-normal6",name:"status",defaultValue:t.status,className:l.textField,onChange:n,error:!!r,helperText:r?r.message:null,InputProps:{readOnly:!0}})}})}),Object(F.jsx)("div",{})]}),Object(F.jsx)(f.g,{colSpan:2,children:J.filter((function(e){return void 0!==e.name&&null!==e.name})).map((function(e){return Object(F.jsx)(f.b,{display:"inline-flex",w:"50%",h:150,mb:8,mr:8,p:4,border:"1px solid #eaeaea",borderRadius:2,children:Object(F.jsxs)(f.h,{p:5,children:[Object(F.jsx)(x.a,{src:e.preview,alt:e.name,display:"block",w:"auto",h:"100%"}),Object(F.jsx)(f.o,{children:Object(F.jsx)(g.b,{size:"sm","aria-label":"view image",icon:Object(F.jsx)(C.b,{}),onClick:function(){return function(e){var t={url:e.preview,name:e.name};Z((function(e){return t})),ae()}({preview:e.preview,name:e.name,type:e.preview.split(".").pop()})}})})]})},e.name)}))})]})})]}),Object(F.jsxs)(v.g,{closeOnOverlayClick:!1,isOpen:te,onClose:ne,size:"3xl",children:[Object(F.jsx)(v.m,{}),Object(F.jsxs)(v.j,{children:[Object(F.jsx)(v.l,{children:K.name}),Object(F.jsx)(v.i,{}),Object(F.jsx)(v.h,{pb:6,children:Object(F.jsx)(f.b,{display:"inline-flex",w:"100%",h:"800",mb:8,mr:8,p:4,border:"1px solid #eaeaea",borderRadius:2,children:Object(F.jsx)(V,{imagefile:K})})}),Object(F.jsx)(v.k,{children:Object(F.jsx)(d.a,{onClick:ne,children:"Close"})})]})]})]})}}}]);
//# sourceMappingURL=2.1afefdcd.chunk.js.map