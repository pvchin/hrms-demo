(this.webpackJsonphrms=this.webpackJsonphrms||[]).push([[4],{1056:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return z}));var n=a(4),c=a(9),o=a(2),i=a(24),r=a.n(i),s=a(91),l=a(92),u=a(453),d=a(408),b=a(97),j=a(126),f=a(65),p=a.n(f),v=a(451),O=a.n(v),h=a(42),m=a.n(h),x=a(68),g=a.n(x),_=a(69),y=a.n(_),C=a(364),S=a(23),k=a(30),w=a(48),D=a(21),A=a(76),E=a(82),L=a(7),R=a.n(L),T=a(12),B=a(16),F=a(13),J=a(363),P=a(28),G=a.n(P),I=a(38);function N(){return(N=Object(T.a)(R.a.mark((function e(t){var a,n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(F.x,"?fi=").concat(t));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){var t=Object(o.useState)("all"),a=Object(c.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(""),s=Object(c.a)(r,2),l=s[0],u=s[1],d=Object(o.useCallback)((function(e){return Object(J.a)(e,n)}),[n]),b=Object(B.useQuery)([I.a.leavesstatus,l],(function(){return function(e){return N.apply(this,arguments)}(l)}),{select:"all"!==n?d:void 0}).data;return{leavesstatus:void 0===b?[]:b,leavestatusfilter:n,setLeaveStatusFilter:i,setLeaveStatusId:u}}var Y=a(366),K=a(360),M=a(81),Q=a(1),V={name:"",to_date:"",from_date:"",reason:"",status:"Pending",no_of_days:0,leave_bal:0},W=[{title:"Name",field:"name",editable:"never"},{title:"From Date",field:"from_date",type:"date",dateSetting:{locale:"en-GB"},editable:"never"},{title:"To Date",field:"to_date",type:"date",dateSetting:{locale:"en-GB"},editable:"never"},{title:"Leave Balance",field:"leave_bal",type:"numeric",editable:"never"},{title:"No of Days",field:"no_of_days",type:"numeric",editable:"never"},{title:"Reason",field:"reason",editable:"never"},{title:"Status",field:"status",editComponent:function(e){return Object(Q.jsxs)(s.a,{onChange:function(t){return e.onChange(t.target.value)},style:{width:100},value:e.value,select:!0,children:[Object(Q.jsx)(l.a,{value:"Pending",children:"Pending"}),Object(Q.jsx)(l.a,{value:"Approve",children:"Approve"}),Object(Q.jsx)(l.a,{value:"Reject",children:"Reject"}),Object(Q.jsx)(l.a,{value:"Cancel",children:"Cancel"})]})}}];function z(){var e=H(),t=Object(D.a)(),a=Object(M.a)().employees,s=q(),l=s.leavesstatus,b=s.setLeaveStatusId,f=Object(K.a)(),v=Object(Y.a)(),h=Object(o.useState)(V),x=Object(c.a)(h,2),_=x[0],L=x[1],R=Object(S.c)(k.f),T=Object(c.a)(R,2),B=T[0],F=(T[1],Object(o.useState)(!1)),J=Object(c.a)(F,2),P=J[0],G=J[1],I=Object(o.useState)(!1),N=Object(c.a)(I,2),z=N[0],U=N[1],X=Object(o.useState)(!0),Z=Object(c.a)(X,2),$=(Z[0],Z[1]),ee=l.filter((function(e){return e.reporting_email===B.loginEmail})),te=Object(E.b)().editLeaveID;Object(o.useEffect)((function(){b("Pending")}),[]);var ae=function(){G(!1)},ne=function(e,c){var o=e.from_date,i=e.to_date,r=e.name,s=e.empid,l=a.filter((function(e){return e.id===s})).map((function(e){return Object(n.a)({},e)}));console.log("leave form",e,l);var u={to_name:r,to_email:l[0].email,message:"Your leave application from ".concat(o," to ").concat(i," has been ").concat(c,"!"),cc_to:"pvchinbn@gmail.com"};j.a("service_ffxn6vb","template_1y8odlq",u,"user_oLsKrJJYgmAa4uBnRGkuq").then((function(e){console.log(e.status,e.text),t({title:"Email has sent successfully to ".concat(u.to_email,"!"),status:"success"})}),(function(e){console.log(e),t({title:"Email has fail to send to ".concat(u.to_email,"!"),status:"warning"})}))},ce=function(){ee.forEach((function(e){e.tableData.checked&&(e.status="Approved",f({id:e.id,status:"Approved"}),t({title:"Leave record being approved!",status:"success"}),ne(e,"Approved"))})),ee.forEach((function(e){e.tableData&&(e.tableData.checked=!1)}))},oe=function(){ee.forEach((function(e){e.tableData.checked&&(e.status="Rejected",f({id:e.id,status:"Rejected"}),$(!0),t({title:"Leave record being rejected!",status:"success"}),ne(e,"Approved"))})),ee.forEach((function(e){e.tableData&&(e.tableData.checked=!1)}))};return Object(Q.jsx)("div",{className:e.root,children:Object(Q.jsxs)("div",{style:{maxWidth:"100%",paddingTop:"5px"},children:[Object(Q.jsx)(r.a,{columns:W,data:ee,title:"Leave Application",icons:{Add:function(e){return Object(Q.jsx)(p.a,{})},Edit:function(e){return Object(Q.jsx)(p.a,{})},View:function(e){return Object(Q.jsx)(O.a,{})},Delete:function(e){return Object(Q.jsx)(m.a,{})},Clear:function(e){return Object(Q.jsx)(m.a,{})},Check:function(e){return Object(Q.jsx)(g.a,{})},Search:function(e){return Object(Q.jsx)(y.a,{})},ResetSearch:function(e){return Object(Q.jsx)(m.a,{})}},actions:[],options:{filtering:!0,selection:!0,paging:!1,headerStyle:{backgroundColor:"rgba(75, 192, 192, 1)",color:"white"},showTitle:!0},components:{Toolbar:function(e){return Object(Q.jsxs)("div",{children:[Object(Q.jsx)(i.MTableToolbar,Object(n.a)({},e)),Object(Q.jsxs)(u.h,{p:2,children:[Object(Q.jsx)(d.a,{type:"submit",variant:"solid",color:"white",bgColor:"red",onClick:ce,children:"Approve"}),Object(Q.jsx)(d.a,{type:"submit",variant:"solid",color:"white",bgColor:"red",onClick:oe,children:"Reject"})]})]})}}}),Object(Q.jsx)(w.a,{isOpen:P,handleClose:ae,title:"",showButton:!0,isFullscree:!1,children:Object(Q.jsx)(C.a,{formdata:_,setFormdata:L,handleDialogClose:ae})}),Object(Q.jsx)(A.a,{onClose:function(){U(!1)},onConfirm:function(){v(te)},isOpen:z,title:"Delete Expenses",children:Object(Q.jsx)("h2",{children:"Are you sure you want to delete ?"})})]})})}var H=Object(b.a)((function(e){return{root:{padding:0}}}))}}]);
//# sourceMappingURL=4.d869ecd4.chunk.js.map