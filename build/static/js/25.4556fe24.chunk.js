(this.webpackJsonphrms=this.webpackJsonphrms||[]).push([[25],{1073:function(e,t,a){"use strict";a.r(t);var n=a(31),r=a(4),i=a(9),c=a(1),o=a(87),l=a(27),s=a.n(l),d=a(11),u=a(53),b=a(117),p=a(129),m=a(88),j=a(133),y=a(211),h=a(620),f=a(75),O=a(404),x=a(212),_=a(23),g=a(55),w=a(162),v=a(102),k=a(113),N=a(30),S=a(569),C=a(583),P=a(2),D=Object(o.a)((function(e){return{root:{flexGrow:1},button:{margin:e.spacing(1)},container:{margin:0,padding:0,width:"80vw",display:"grid",gridTemplateColumns:"repeat(auto-fill,250px)",gridAutoRows:"10px",position:"absolute",left:"50%",transform:"translateX(-50%)",justifyContent:"center",backgroundColor:"primary"},fixedHeight:{height:800},paper:{padding:e.spacing(10),display:"flex",overflow:"auto",flexDirection:"column",border:"1px solid",width:"100%",color:"primary",bcakgroundColor:"black"},card:{backgroundColor:"black"},section:{width:"95vw",margin:"5rem auto",maxWidth:"var(--max-width)"},underline:{width:"5rem",height:"0.25rem",marginBottom:"1.25rem",background:"var(--clr-primary-5)",marginLeft:"auto",marginRight:"auto"},title:{marginbottom:"4rem",textAlign:"center"},jobscenter:{width:"80vw",margin:"0 auto",maxWidth:"var(--max-width)",flexDirection:"row"},btncontainer:{display:"flex",flexDirection:"row",justifyContent:"center",marginBottom:"4rem",flexWrap:"wrap"},jobbtn:{background:"transparent",borderColor:"transparent",textTransform:"capitalize",fontSize:"1.25rem",letterSpacing:"var(--spacing)",margin:"0 0.5rem",transition:"var(--transition)",cursor:"pointer",padding:"0.25rem 0",lineHeight:"1",outlineColor:"var(--clr-primary-10)","&:hover":{color:"var(--clr-primary-5)",boxShadow:"0 2px var(--clr-primary-5)"}},activebtn:{color:"var(--clr-primary-5)",boxShadow:"0 2px var(--clr-primary-5)"},jobinfo:{fontWeight:"400"},rightIcon:{marginLeft:e.spacing(1)},formLabel:{fontSize:12,textAlign:"left",marginLeft:8,marginTop:5}}}));t.default=function(){var e=Object(u.g)(),t=D(),a=Object(d.a)(t.paper,t.fixedHeight),o=Object(S.a)().currency,l=Object(f.e)(),E=l.isOpen,L=l.onOpen,I=l.onClose,M=Object(c.useState)(!1),T=Object(i.a)(M,2),q=T[0],A=T[1],B=Object(g.b)(),W=B.loadEmployees,z=B.employees,F=Object(v.b)(),H=F.loadUnpaidExpenses,R=F.unpaidexpenses,G=F.updateExpense,J=Object(k.b)(),U=J.unpaiddailyallows,V=J.loadUnpaidDailyAllows,X=J.updateDailyAllowance,Y=Object(w.b)(),K=Y.addPayrun,Q=Y.getPayrun,Z=Y.payrun,$=Y.payrun_loading,ee=Y.addPayslip,te=Y.resetPayslipsData,ae=Y.singlebatch_payslip_loading,ne=Y.setPayslipPeriod,re=Object(_.c)(N.j),ie=Object(i.a)(re,2),ce=ie[0],oe=ie[1],le=Object(_.c)(N.i),se=Object(i.a)(le,2),de=(se[0],se[1]),ue=Object(c.useState)(!1),be=Object(i.a)(ue,2),pe=be[0],me=be[1],je=Object(c.useState)(!1),ye=Object(i.a)(je,1)[0],he=Object(c.useState)(!1),fe=Object(i.a)(he,2),Oe=fe[0],xe=fe[1],_e=Object(c.useState)(!1),ge=Object(i.a)(_e,2),we=ge[0],ve=ge[1],ke=Object(c.useState)(!1),Ne=Object(i.a)(ke,2),Se=Ne[0],Ce=Ne[1],Pe=z.filter((function(e){return!e.hasresigned&&!e.nonpayroll})),De=Object(c.useMemo)((function(){return[{title:"NAME",field:"name",editable:"never",cellStyle:{width:280,maxWidth:280}}]}),[]);function Ee(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}Object(c.useEffect)((function(){$||A(!1)}),[q]);var Le=function(e){oe(Object(r.a)(Object(r.a)({},ce),{},Object(n.a)({},e.target.name,e.target.value)))},Ie=function(e,t){var a=0,n=0,i=0,c=0,l=0,s=0,d=0,u=0,b=0,p=0,m=0,j=0,y=0,h=0,f=0;te(),Pe&&Pe.forEach((function(O,x){if(a=0,n=0,i=0,c=0,l=0,s=0,d=0,u=0,b=0,p=0,m=0,y=0,h=0,j=0,f=0,O.tableData.checked){a=0,R&&R.filter((function(e){return e.empid===O.id})).map((function(e){return G({id:e.id,payrun:t}),a+=e.amount})),n=0,U&&U.filter((function(e){return e.empid===O.id})).map((function(e){return X({id:e.id,payrun:t}),n+=e.amount}));var _=O.id,g=O.name,w=O.bank_name,v=O.bank_acno,k=O.basic_salary,N=O.salary_currency,S=O.tap_acno,C=O.scp_acno,P=O.tap_checkbox;if(i=k,N&&"BND"!==N){var D=o.filter((function(e){return e.currency===N})).map((function(e){return Object(r.a)({},e)}));u=D[0].rate}else u=1;l=P?Math.ceil(.05*i):0,(s=P?Math.round(.035*(i+Number.EPSILON)*100)/100:0)>98&&(s=98),d=i+n+a+c-l-s,b=Math.round((k+Number.EPSILON)*u*100)/100,m=Math.round((l+Number.EPSILON)*u*100)/100,j=Math.round((s+Number.EPSILON)*u*100)/100,f=Math.round((d+Number.EPSILON)*u*100)/100,y=Math.round((n+Number.EPSILON)*u*100)/100,h=Math.round((a+Number.EPSILON)*u*100)/100,f=b+y+h-m-j;var E={name:g,period:e,pay_date:ce.pay_date,payrun:t,bank_name:w,bank_acno:v,salary_currency:N||"BND",currency_rate:u,tap_acno:S,scp_acno:C,tap_checkbox:P,empid:_,status:"Pending",allows_type1:"Site Allowances",allows_type1amt:n,allows_type2:"Expenses Claims",allows_type2amt:a,allows_type3:" ",allows_type3amt:0,allows_type4:" ",allows_type4amt:0,allows_type5:" ",allows_type5amt:0,allows_type6:" ",allows_type6amt:0,allows_type7:" ",allows_type7amt:0,allows_type8:" ",allows_type8amt:0,deducts_type1:" ",deducts_type1amt:0,deducts_type2:" ",deducts_type2amt:0,deducts_type3:" ",deducts_type3amt:0,deducts_type4:" ",deducts_type4amt:0,deducts_type5:" ",deducts_type5amt:0,deducts_type6:" ",deducts_type6amt:0,deducts_type7:" ",deducts_type7amt:0,deducts_type8:" ",deducts_type8amt:0,wages:i,tap_amount:l,scp_amount:s,total_allowances:c,total_deductions:0,site_allows:n,expenses_claims:a,nett_pay:d,wages_bnd:b,site_allows_bnd:y,expenses_claims_bnd:h,total_allowances_bnd:p,total_deductions_bnd:0,tap_amount_bnd:m,scp_amount_bnd:j,nett_pay_bnd:f};ee(Object(r.a)({},E))}}))},Me=function(e,t){K({pay_freq:ce.payfreq,from_date:ce.fromdate,to_date:ce.todate,pay_date:ce.paydate,period:e,payrun:t,status:"Pending"}),Q()};return Object(c.useEffect)((function(){W(),H(),V(),Q()}),[]),Object(P.jsx)(b.a,{className:a,style:{backgroundColor:"659dbd"},children:Object(P.jsxs)("section",{className:t.section,children:[Object(P.jsxs)(p.a,{direction:"row",container:!0,spacing:1,children:[Object(P.jsx)(p.a,{container:!0,item:!0,sm:3,style:{border:"1px solid black"},direction:"column",align:"left",children:Object(P.jsxs)("article",{className:t.jobinfo,children:[Object(P.jsx)("h2",{children:"Pay Run"}),Object(P.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),de(""),0===Pe.reduce((function(e,t){return t.tableData.checked?e+1:e}),0))return xe(!0),setTimeout((function(){xe(!1)}),3e3),null;var t,a=Ee(ce.fromdate)+" - "+Ee(ce.todate),n=ce.fromdate.substring(0,4)+"-"+ce.fromdate.substring(5,7);oe(Object(r.a)(Object(r.a)({},ce),{},{period:a,payrun:n,status:"New"})),ne(n),(t=n,Z.some((function(e){return e.payrun===t})))?(ve(!0),Ce(!1),me(!0)):(Ie(a,n),Me(a,n),ve(!1),me(!0),Ce(!0),A(!0))},children:[Object(P.jsx)("div",{}),Object(P.jsx)("div",{children:Object(P.jsx)(m.a,{label:"Pay Frequency",variant:"filled",required:!0,defaultValue:"Monthly",style:{width:"100%"},name:"payfreq",value:ce.payfreq,onChange:function(e){return Le(e)},select:!0,children:Object(P.jsx)("option",{value:"Monthly",children:"Monthly"})})}),Object(P.jsx)("div",{children:Object(P.jsx)(m.a,{label:"From Date",variant:"filled",name:"fromdate",type:"date",value:ce.fromdate,required:!0,style:{width:"100%"},onChange:function(e){return Le(e)},InputLabelProps:{shrink:!0}})}),Object(P.jsx)("div",{children:Object(P.jsx)(m.a,{label:"To Date",variant:"filled",type:"date",name:"todate",value:ce.todate,required:!0,onChange:function(e){return Le(e)},style:{width:"100%"},InputLabelProps:{shrink:!0}})}),Object(P.jsx)("div",{children:Object(P.jsx)(m.a,{label:"Payment Date",variant:"filled",type:"date",name:"paydate",value:ce.paydate,required:!0,style:{width:"100%"},onChange:function(e){return Le(e)},InputLabelProps:{shrink:!0}})}),Object(P.jsxs)("div",{children:[Object(P.jsx)("div",{children:Object(P.jsx)(j.a,{variant:"contained",color:"primary",className:t.button,onClick:L,disabled:Se,children:"Currency Exchange Table"})}),Object(P.jsxs)("div",{children:[Object(P.jsxs)(j.a,{type:"submit",variant:"contained",color:"primary",className:t.button,children:["Submit ",Object(P.jsx)(y.a,{className:t.rightIcon,children:"send"})]}),pe&&!we&&Object(P.jsxs)(j.a,{type:"submit",variant:"contained",color:"primary",className:t.button,onClick:function(){e("/payrunbatch")},children:["Next ",Object(P.jsx)(y.a,{className:t.rightIcon,children:"send"})]})]})]}),Object(P.jsxs)("div",{children:[pe&&!we&&!ae&&Object(P.jsx)("h3",{children:"New Payrun being added!"}),pe&&we&&Object(P.jsx)("h3",{children:"This payrun already existed!"})]}),Object(P.jsxs)("div",{children:[ye&&Object(P.jsx)("h3",{children:"This Payrun period already existed!"}),Oe&&Object(P.jsx)("h3",{children:"You must select employees!"})]})]})]})}),Object(P.jsx)(h.a,{orientation:"vertical",flexItem:!0,style:{background:"white"}}),Object(P.jsx)(p.a,{container:!0,item:!0,sm:3,style:{border:"1px solid black"},align:"right",children:Object(P.jsx)(O.b,{h:"500",w:"full",overflow:"scroll",children:Object(P.jsx)(s.a,{columns:De,data:Pe,title:"Employee Listing",options:{filtering:!1,search:!1,toolbar:!0,selection:!0,paging:!1,pageSize:10,headerStyle:{backgroundColor:"#90CDF4",color:"primary"},showTitle:!0}})})})]}),Object(P.jsxs)(x.g,{isOpen:E,onClose:I,children:[Object(P.jsx)(x.m,{}),Object(P.jsxs)(x.j,{children:[Object(P.jsx)(x.l,{children:"Currency Table"}),Object(P.jsx)(x.i,{}),Object(P.jsx)(x.h,{children:Object(P.jsx)(O.b,{children:Object(P.jsx)(C.a,{})})}),Object(P.jsx)(x.k,{children:Object(P.jsx)(j.a,{colorScheme:"blue",mr:3,onClick:I,children:"Close"})})]})]})]})})}}}]);
//# sourceMappingURL=25.4556fe24.chunk.js.map