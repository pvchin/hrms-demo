(this.webpackJsonphrms=this.webpackJsonphrms||[]).push([[3],{1093:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return V}));var n=a(4),c=a(9),o=a(1),i=a(27),r=a.n(i),s=a(88),l=a(89),u=a(404),d=a(405),b=a(87),j=a(163),f=a(67),p=a.n(f),v=a(447),O=a.n(v),h=a(44),m=a.n(h),x=a(72),g=a.n(x),_=a(73),y=a.n(_),C=a(355),S=a(23),k=a(30),w=a(50),D=a(19),A=a(77),E=a(96),L=a(7),R=a.n(L),T=a(12),B=a(16),F=a(13),J=a(241),P=a(26),G=a.n(P),I=a(37);function N(){return(N=Object(T.a)(R.a.mark((function e(t){var a,n;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.a.get("".concat(F.z,"?fi=").concat(t));case 2:return a=e.sent,n=a.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e){var t=Object(o.useState)("all"),a=Object(c.a)(t,2),n=a[0],i=a[1],r=Object(o.useState)(""),s=Object(c.a)(r,2),l=s[0],u=s[1],d=Object(o.useCallback)((function(e){return Object(J.a)(e,n)}),[n]),b=Object(B.useQuery)([I.a.leavesstatus,l],(function(){return function(e){return N.apply(this,arguments)}(l)}),{select:"all"!==n?d:void 0}).data;return{leavesstatus:void 0===b?[]:b,leavestatusfilter:n,setLeaveStatusFilter:i,setLeaveStatusId:u}}var M=a(362),Y=a(242),z=a(95),K=a(2),Q={name:"",to_date:"",from_date:"",reason:"",status:"Pending",no_of_days:0,leave_bal:0};function V(){var e=W(),t=Object(D.a)(),a=Object(z.a)().employees,b=q(),f=b.leavesstatus,v=b.setLeaveStatusId,h=Object(Y.a)(),x=Object(M.a)(),_=Object(o.useState)(Q),L=Object(c.a)(_,2),R=L[0],T=L[1],B=Object(S.c)(k.f),F=Object(c.a)(B,2),J=F[0],P=(F[1],Object(o.useState)(!1)),G=Object(c.a)(P,2),I=G[0],N=G[1],V=Object(o.useState)(!1),H=Object(c.a)(V,2),U=H[0],X=H[1],Z=Object(o.useState)(!0),$=Object(c.a)(Z,2),ee=($[0],$[1]),te=f.filter((function(e){return e.reporting_email===J.loginEmail})),ae=Object(E.b)().editLeaveID,ne=Object(o.useMemo)((function(){return[{title:"Name",field:"name",editable:"never"},{title:"From Date",field:"from_date",type:"date",dateSetting:{locale:"en-GB"},editable:"never"},{title:"To Date",field:"to_date",type:"date",dateSetting:{locale:"en-GB"},editable:"never"},{title:"Leave Balance",field:"leave_bal",type:"numeric",editable:"never"},{title:"No of Days",field:"no_of_days",type:"numeric",editable:"never"},{title:"Reason",field:"reason",editable:"never"},{title:"Status",field:"status",editComponent:function(e){return Object(K.jsxs)(s.a,{onChange:function(t){return e.onChange(t.target.value)},style:{width:100},value:e.value,select:!0,children:[Object(K.jsx)(l.a,{value:"Pending",children:"Pending"}),Object(K.jsx)(l.a,{value:"Approve",children:"Approve"}),Object(K.jsx)(l.a,{value:"Reject",children:"Reject"}),Object(K.jsx)(l.a,{value:"Cancel",children:"Cancel"})]})}}]}),[]);Object(o.useEffect)((function(){v("Pending")}),[]);var ce=function(){N(!1)},oe=function(e,c){var o=e.from_date,i=e.to_date,r=e.name,s=e.empid,l=a.filter((function(e){return e.id===s})).map((function(e){return Object(n.a)({},e)}));console.log("leave form",e,l);var u={to_name:r,to_email:l[0].email,message:"Your leave application from ".concat(o," to ").concat(i," has been ").concat(c,"!"),cc_to:"pvchinbn@gmail.com"};j.a("service_ffxn6vb","template_1y8odlq",u,"user_oLsKrJJYgmAa4uBnRGkuq").then((function(e){console.log(e.status,e.text),t({title:"Email has sent successfully to ".concat(u.to_email,"!"),status:"success"})}),(function(e){console.log(e),t({title:"Email has fail to send to ".concat(u.to_email,"!"),status:"warning"})}))},ie=function(){te.forEach((function(e){e.tableData.checked&&(e.status="Approved",h({id:e.id,status:"Approved"}),t({title:"Leave record being approved!",status:"success"}),oe(e,"Approved"))})),te.forEach((function(e){e.tableData&&(e.tableData.checked=!1)}))},re=function(){te.forEach((function(e){e.tableData.checked&&(e.status="Rejected",h({id:e.id,status:"Rejected"}),ee(!0),t({title:"Leave record being rejected!",status:"success"}),oe(e,"Approved"))})),te.forEach((function(e){e.tableData&&(e.tableData.checked=!1)}))};return Object(K.jsx)("div",{className:e.root,children:Object(K.jsxs)("div",{style:{maxWidth:"100%",paddingTop:"5px"},children:[Object(K.jsx)(r.a,{columns:ne,data:te,title:"Leave Application",icons:{Add:function(e){return Object(K.jsx)(p.a,{})},Edit:function(e){return Object(K.jsx)(p.a,{})},View:function(e){return Object(K.jsx)(O.a,{})},Delete:function(e){return Object(K.jsx)(m.a,{})},Clear:function(e){return Object(K.jsx)(m.a,{})},Check:function(e){return Object(K.jsx)(g.a,{})},Search:function(e){return Object(K.jsx)(y.a,{})},ResetSearch:function(e){return Object(K.jsx)(m.a,{})}},actions:[],options:{filtering:!0,selection:!0,paging:!1,headerStyle:{backgroundColor:"rgba(75, 192, 192, 1)",color:"white"},showTitle:!0},components:{Toolbar:function(e){return Object(K.jsxs)("div",{children:[Object(K.jsx)(i.MTableToolbar,Object(n.a)({},e)),Object(K.jsxs)(u.h,{p:2,children:[Object(K.jsx)(d.a,{type:"submit",variant:"solid",color:"white",bgColor:"red",onClick:ie,children:"Approve"}),Object(K.jsx)(d.a,{type:"submit",variant:"solid",color:"white",bgColor:"red",onClick:re,children:"Reject"})]})]})}}}),Object(K.jsx)(w.a,{isOpen:I,handleClose:ce,title:"",showButton:!0,isFullscree:!1,children:Object(K.jsx)(C.a,{formdata:R,setFormdata:T,handleDialogClose:ce})}),Object(K.jsx)(A.a,{onClose:function(){X(!1)},onConfirm:function(){x(ae)},isOpen:U,title:"Delete Expenses",children:Object(K.jsx)("h2",{children:"Are you sure you want to delete ?"})})]})})}var W=Object(b.a)((function(e){return{root:{padding:0}}}))}}]);
//# sourceMappingURL=3.d439272d.chunk.js.map