{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState } from \"react\";\nimport { useQuery, useQueryClient } from \"react-query\";\nimport { queryKeys } from \"../react-query/constants\";\nimport { clearStoredUser, getStoredUser, setStoredUser } from \"../user-storage\";\n\nasync function getUser(user) {\n  return getStoredUser(); //if (!user) return null;\n  //return user;\n  //   const data = employees\n  //     .filter((f) => f.email === user)\n  //     .map((r) => {\n  //       return { ...r };\n  //     });\n  //return user;\n  //   if (!user) return null;\n  //   const { data } = await axiosInstance.get(`/user/${user.id}`, {\n  //     headers: getJWTHeader(user),\n  //   });\n  //   return data.user;\n}\n\nexport function useUser() {\n  _s();\n\n  const [user, setUser] = useState(getStoredUser() || null);\n  const queryClient = useQueryClient();\n  useQuery(queryKeys.user, () => getUser(user), {\n    enabled: !!user,\n    onSuccess: data => setUser(data)\n  }); // meant to be called from useAuth\n\n  function updateUser(newUser) {\n    // set user in state\n    setUser(newUser); // update user in localstorage\n\n    setStoredUser(newUser); // TODO: pre-populate user profile in React Query client\n  } // meant to be called from useAuth\n\n\n  function clearUser() {\n    // update state\n    setUser(null); // remove from localstorage\n\n    clearStoredUser();\n    queryClient.setQueryData(queryKeys.user, null);\n    queryClient.removeQueries([queryKeys.user]);\n  }\n\n  return {\n    user,\n    updateUser,\n    clearUser\n  };\n}\n\n_s(useUser, \"HO8f/cqqipXQOONvghmQS7dOUPg=\", false, function () {\n  return [useQueryClient, useQuery];\n});","map":{"version":3,"sources":["D:/react-myprojects/hrms-demo/src/components/user/useUser.js"],"names":["useState","useQuery","useQueryClient","queryKeys","clearStoredUser","getStoredUser","setStoredUser","getUser","user","useUser","setUser","queryClient","enabled","onSuccess","data","updateUser","newUser","clearUser","setQueryData","removeQueries"],"mappings":";;AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,SAASC,QAAT,EAAmBC,cAAnB,QAAyC,aAAzC;AAEA,SAASC,SAAT,QAA0B,0BAA1B;AACA,SAASC,eAAT,EAA0BC,aAA1B,EAAyCC,aAAzC,QAA8D,iBAA9D;;AAEA,eAAeC,OAAf,CAAuBC,IAAvB,EAA6B;AAC3B,SAAOH,aAAa,EAApB,CAD2B,CAE3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACD;;AAED,OAAO,SAASI,OAAT,GAAmB;AAAA;;AACxB,QAAM,CAACD,IAAD,EAAOE,OAAP,IAAkBV,QAAQ,CAACK,aAAa,MAAM,IAApB,CAAhC;AACA,QAAMM,WAAW,GAAGT,cAAc,EAAlC;AAEAD,EAAAA,QAAQ,CAACE,SAAS,CAACK,IAAX,EAAiB,MAAMD,OAAO,CAACC,IAAD,CAA9B,EAAsC;AAC5CI,IAAAA,OAAO,EAAE,CAAC,CAACJ,IADiC;AAE5CK,IAAAA,SAAS,EAAGC,IAAD,IAAUJ,OAAO,CAACI,IAAD;AAFgB,GAAtC,CAAR,CAJwB,CASxB;;AACA,WAASC,UAAT,CAAoBC,OAApB,EAA6B;AAC3B;AACAN,IAAAA,OAAO,CAACM,OAAD,CAAP,CAF2B,CAI3B;;AACAV,IAAAA,aAAa,CAACU,OAAD,CAAb,CAL2B,CAO3B;AACD,GAlBuB,CAoBxB;;;AACA,WAASC,SAAT,GAAqB;AACnB;AACAP,IAAAA,OAAO,CAAC,IAAD,CAAP,CAFmB,CAInB;;AACAN,IAAAA,eAAe;AAEfO,IAAAA,WAAW,CAACO,YAAZ,CAAyBf,SAAS,CAACK,IAAnC,EAAyC,IAAzC;AAEAG,IAAAA,WAAW,CAACQ,aAAZ,CAA0B,CAAChB,SAAS,CAACK,IAAX,CAA1B;AACD;;AAED,SAAO;AAAEA,IAAAA,IAAF;AAAQO,IAAAA,UAAR;AAAoBE,IAAAA;AAApB,GAAP;AACD;;GAlCeR,O;UAEMP,c,EAEpBD,Q","sourcesContent":["import { useState } from \"react\";\r\nimport { useQuery, useQueryClient } from \"react-query\";\r\n\r\nimport { queryKeys } from \"../react-query/constants\";\r\nimport { clearStoredUser, getStoredUser, setStoredUser } from \"../user-storage\";\r\n\r\nasync function getUser(user) {\r\n  return getStoredUser()\r\n  //if (!user) return null;\r\n  //return user;\r\n  //   const data = employees\r\n  //     .filter((f) => f.email === user)\r\n  //     .map((r) => {\r\n  //       return { ...r };\r\n  //     });\r\n  //return user;\r\n  //   if (!user) return null;\r\n  //   const { data } = await axiosInstance.get(`/user/${user.id}`, {\r\n  //     headers: getJWTHeader(user),\r\n  //   });\r\n\r\n  //   return data.user;\r\n}\r\n\r\nexport function useUser() {\r\n  const [user, setUser] = useState(getStoredUser() || null);\r\n  const queryClient = useQueryClient();\r\n\r\n  useQuery(queryKeys.user, () => getUser(user), {\r\n    enabled: !!user,\r\n    onSuccess: (data) => setUser(data),\r\n  });\r\n\r\n  // meant to be called from useAuth\r\n  function updateUser(newUser) {\r\n    // set user in state\r\n    setUser(newUser);\r\n\r\n    // update user in localstorage\r\n    setStoredUser(newUser);\r\n\r\n    // TODO: pre-populate user profile in React Query client\r\n  }\r\n\r\n  // meant to be called from useAuth\r\n  function clearUser() {\r\n    // update state\r\n    setUser(null);\r\n\r\n    // remove from localstorage\r\n    clearStoredUser();\r\n\r\n    queryClient.setQueryData(queryKeys.user, null);\r\n\r\n    queryClient.removeQueries([queryKeys.user]);\r\n  }\r\n\r\n  return { user, updateUser, clearUser };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}